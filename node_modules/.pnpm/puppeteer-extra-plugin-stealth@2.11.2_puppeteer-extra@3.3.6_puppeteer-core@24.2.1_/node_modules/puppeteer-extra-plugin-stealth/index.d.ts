import asyncio
import logging

from playwright.async_api import async_playwright

# Logger einrichten (nur als Beispiel)
logger = logging.getLogger(__name__)
logging.basicConfig(level=logging.INFO)

async def log_canvas_fingerprint():
    # Playwright starten
    async with async_playwright() as p:
        # Chromium (oder Firefox/WebKit) im headless-Modus starten
        browser = await p.chromium.launch(headless=True)
        page = await browser.new_page()

        # Zu browserleaks.com/canvas navigieren
        await page.goto("https://browserleaks.com/canvas")

        # Auf das Element mit ID canvas-hash warten
        await page.wait_for_selector("#canvas-hash")

        # gesamten HTML-Content holen
        content = await page.content()

        # Zeilenweise durchsuchen
        for line in content.split("\n"):
            if 'id="canvas-hash"' in line:
                logger.info(f"Canvas fingerprint: {line}")

        # Browser beenden
        await browser.close()

if __name__ == "__main__":
    asyncio.run(log_canvas_fingerprint())
